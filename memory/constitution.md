<!--
Sync Impact Report
==================
버전 변경: 없음 → v1.0.0
이유: 초기 헌장 수립 (MINOR 버전으로 시작)

수정된 원칙: 없음 (신규 생성)
추가된 섹션:
  - 모든 핵심 원칙 (1-8)
  - 거버넌스 섹션

제거된 섹션: 없음

템플릿 업데이트 상태:
  ⚠ /templates/plan-template.md - 아직 생성되지 않음
  ⚠ /templates/spec-template.md - 아직 생성되지 않음
  ⚠ /templates/tasks-template.md - 아직 생성되지 않음

후속 TODO:
  - 템플릿 파일들이 생성되면 헌장 원칙과 일치하도록 업데이트 필요
  - 프로젝트 진행에 따라 원칙 구체화 필요
-->

# TwinCAT 자동화 시스템 프로젝트 헌장

**버전**: v1.0.0
**비준일**: 2025-11-20
**최종 수정일**: 2025-11-20

---

## 목적

본 헌장은 TwinCAT 기반 자동화 시스템 개발의 핵심 원칙과 거버넌스 구조를 정의합니다.
모든 기여자는 이 원칙들을 준수해야 하며, 코드 리뷰와 병합 승인 과정에서 이 헌장 준수 여부를 검증합니다.

---

## 핵심 원칙

### 원칙 1: 한글 우선 원칙 (Korean-First Principle)

**규칙**:
- 모든 대화, 주석, 문서, 커밋 메시지는 **반드시 한글**로 작성해야 함
- 코드 변수명과 함수명은 영어 사용 가능 (호환성 및 국제 표준 준수)
- 기술 용어는 한글 설명과 함께 영문 병기 가능 (예: "함수 블록 (Function Block)")

**근거**:
- 팀 내 의사소통 효율성 극대화
- 기술 문서의 접근성 향상
- 유지보수 시 코드 이해도 향상

**검증 방법**:
- 커밋 전 모든 주석 및 문서의 언어 확인
- PR 리뷰 시 한글 사용 여부 체크리스트 통과 필수

---

### 원칙 2: 실시간 안전성 우선 (Real-Time Safety First)

**규칙**:
- 모든 PLC 코드는 **결정론적 실행 시간**을 보장해야 함
- 사이클 타임 내 완료되지 않는 연산은 여러 사이클로 분산
- 비상 정지 로직은 모든 제어 로직보다 **최우선 순위**로 처리
- 안전 관련 Function Block은 IEC 61508 SIL 기준 준수

**근거**:
- 산업 자동화 환경에서 실시간 응답성이 시스템 안정성과 직결됨
- 예측 불가능한 지연은 물리적 손상이나 안전 사고로 이어질 수 있음

**검증 방법**:
- 각 Function Block의 최대 실행 시간 측정 및 문서화
- 사이클 타임 초과 모니터링 활성화
- 안전 로직 단위 테스트 필수

---

### 원칙 3: 모듈화 및 재사용성 (Modularity and Reusability)

**규칙**:
- 모든 제어 로직은 **Function Block (FB)** 단위로 캡슐화
- FB는 단일 책임 원칙을 따라야 하며, 명확한 입력/출력 인터페이스를 가져야 함
- 프로젝트 간 공유 가능한 공통 FB는 별도 라이브러리로 관리
- FB 명명 규칙: `FB_<기능명>` (예: `FB_ConveyorControl`, `FB_MotorController`)

**근거**:
- 코드 중복 최소화 및 유지보수성 향상
- 검증된 모듈의 재사용으로 개발 속도 향상
- 단위 테스트 및 디버깅 용이성

**검증 방법**:
- 각 FB는 단일 파일로 관리
- FB 재사용 시 버전 관리 및 의존성 명시
- 공통 라이브러리는 별도 Git 저장소 또는 디렉토리에서 관리

---

### 원칙 4: 상태 기반 설계 (State-Machine Design)

**규칙**:
- 복잡한 시퀀스 제어는 **명시적 상태 머신**으로 구현
- 상태 전이 조건을 명확히 정의하고 주석으로 설명
- 각 상태는 열거형 (ENUM)으로 정의하여 가독성 향상
- 비정상 상태 진입 시 안전 상태로 전환하는 폴백(fallback) 로직 필수

**근거**:
- 상태 머신은 복잡한 로직을 구조화하고 예측 가능하게 만듦
- 디버깅 및 문제 추적 시 현재 상태 확인으로 빠른 원인 파악 가능

**검증 방법**:
- 모든 시퀀스 로직은 상태 다이어그램 문서 필수
- 상태 전이 매트릭스 작성 및 리뷰
- 시뮬레이션을 통한 모든 상태 전이 경로 검증

---

### 원칙 5: 명명 규칙 준수 (Naming Convention Compliance)

**규칙**:
- **Function Block**: `FB_` 접두사 (예: `FB_AxisControl`)
- **전역 변수**: `g` 접두사 (예: `gSystemStatus`)
- **로컬 변수**: camelCase (예: `currentSpeed`, `isRunning`)
- **상수**: UPPER_CASE (예: `MAX_SPEED`, `DEFAULT_TIMEOUT`)
- **데이터 타입 (DUT)**: `T_` 접두사 (예: `T_MotorStatus`)
- **열거형**: `E_` 접두사 (예: `E_MachineState`)

**근거**:
- 일관된 명명 규칙은 코드 가독성과 유지보수성을 크게 향상시킴
- 변수 스코프와 타입을 이름에서 즉시 파악 가능

**검증 방법**:
- 코드 리뷰 시 명명 규칙 체크리스트 확인
- 정적 분석 도구 활용 (가능한 경우)

---

### 원칙 6: 문서화 의무 (Documentation Requirement)

**규칙**:
- 모든 Function Block은 **한글 주석**으로 목적, 입력, 출력, 사용 예시 명시
- 복잡한 알고리즘은 단계별 설명 주석 추가
- 프로젝트 주요 모듈은 `/docs` 디렉토리에 별도 설계 문서 작성
- 변경 이력은 Git 커밋 메시지와 CHANGELOG.md에 기록

**근거**:
- 자동화 시스템은 장기간 운영되므로, 명확한 문서가 없으면 유지보수 불가능
- 팀원 교체나 인수인계 시 문서가 유일한 지식 전달 수단

**검증 방법**:
- PR 병합 전 문서 업데이트 여부 확인
- 주요 Function Block에 대한 사용 예시 코드 필수

---

### 원칙 7: 버전 관리 및 추적성 (Version Control and Traceability)

**규칙**:
- 모든 코드 변경은 **Git을 통해서만** 수행
- 커밋 메시지 형식: `<타입>: <설명>` (예: `기능: 컨베이어 제어 로직 추가`)
  - 타입: `기능`, `수정`, `문서`, `리팩토링`, `테스트`
- 브랜치 전략: `main` (안정), `develop` (개발), `feature/*` (기능별)
- TwinCAT 자동 생성 파일 (.tmc, .tpy 등)은 `.gitignore`에 등록

**근거**:
- 변경 이력 추적으로 문제 발생 시 원인 파악 및 롤백 가능
- 팀 협업 시 충돌 최소화 및 병렬 개발 지원

**검증 방법**:
- PR 병합 전 커밋 메시지 형식 검증
- 브랜치 보호 규칙 설정 (main 직접 푸시 금지)

---

### 원칙 8: 테스트 및 시뮬레이션 (Testing and Simulation)

**규칙**:
- 모든 새로운 Function Block은 **시뮬레이션 환경**에서 먼저 검증
- 실제 하드웨어 배포 전 단위 테스트 및 통합 테스트 수행
- 테스트 케이스는 `/tests` 디렉토리에 문서화
- 회귀 테스트를 위한 테스트 시나리오 유지

**근거**:
- 산업 현장에서 미검증 코드 배포는 안전 사고 및 생산 중단 위험
- 시뮬레이션을 통한 사전 검증으로 현장 투입 시간 단축

**검증 방법**:
- PR 병합 전 테스트 결과 첨부 필수
- 주요 기능은 최소 3가지 이상의 테스트 시나리오 보유

---

## 거버넌스

### 헌장 수정 절차

1. **제안**: 헌장 수정이 필요한 경우 Issue 생성 및 팀 논의
2. **리뷰**: 최소 2명 이상의 팀원 승인 필요
3. **버전 갱신**: Semantic Versioning 규칙에 따라 버전 업데이트
   - **MAJOR**: 호환성 깨지는 원칙 변경 또는 제거
   - **MINOR**: 새로운 원칙 추가 또는 중요 확장
   - **PATCH**: 문구 명확화, 오타 수정 등 비의미적 변경
4. **문서화**: `LAST_AMENDED_DATE` 및 Sync Impact Report 업데이트
5. **전파**: 관련 템플릿 및 문서에 변경사항 반영

### 준수 검증

- **코드 리뷰**: 모든 PR은 헌장 원칙 준수 여부 확인
- **주기적 감사**: 분기별로 프로젝트 전체 코드의 헌장 준수 상태 점검
- **교육**: 신규 팀원은 헌장 숙지 후 개발 참여

### 예외 처리

- 헌장 원칙 예외가 필요한 경우, 명확한 근거와 함께 Issue에 기록
- 예외는 일시적이며, 가능한 빨리 헌장 준수 상태로 복귀해야 함

---

## 부록: 용어 정의

- **PLC (Programmable Logic Controller)**: 프로그래머블 로직 컨트롤러, 산업 자동화용 제어 장치
- **TwinCAT**: Beckhoff의 PC 기반 실시간 제어 소프트웨어 플랫폼
- **Function Block (FB)**: 입력/출력을 가진 재사용 가능한 프로그램 모듈
- **IEC 61131-3**: PLC 프로그래밍 언어 국제 표준
- **사이클 타임 (Cycle Time)**: PLC가 프로그램 한 번을 실행하는 데 걸리는 시간
- **상태 머신 (State Machine)**: 시스템의 동작을 이산적인 상태와 전이로 모델링하는 설계 패턴

---

**이 헌장은 프로젝트의 최상위 규범이며, 모든 개발 활동은 이 원칙들을 기반으로 수행되어야 합니다.**
